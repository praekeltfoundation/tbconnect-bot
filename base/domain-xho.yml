intents:
  - request_tbcheck
  - affirm
  - deny
  - inform
  - maybe
  - more
  - chitchat
  - address
  - opt_in
  - exit:
      triggers: action_exit

entities:
  - province
  - number

actions:
  - action_set_activation
  - action_study_restriction
  - action_session_start
  - action_exit
  - action_opt_in
  - utter_ask_mobile_no
  - utter_ask_terms
  - utter_ask_age
  - utter_ask_gender
  - utter_ask_location
  - utter_ask_location_confirm
  - utter_ask_symptoms_cough
  - utter_ask_symptoms_fever
  - utter_ask_symptoms_sweat
  - utter_ask_symptoms_weight
  - utter_ask_exposure
  - utter_ask_tracing
  - utter_risk_high
  - utter_risk_moderate
  - utter_risk_low
  - utter_control
  - utter_health_consequence
  - utter_planning_prompt
  - utter_ask_soft_commitment
  - utter_commitment_yes
  - utter_soft_commitment_no
  - utter_ask_soft_commitment_plus
  - utter_soft_commitment_plus_no
  - utter_risk_low_unknown_exposure
  - utter_follow_up_request
  - utter_keywords
  - utter_opt_in_yes
  - utter_do_tb_screening
  - utter_ask_research_consent
  - utter_ask_clinic_list
  - utter_ask_clinic_visit_day

slots:
  mobile_no:
    type: unfeaturized
    auto_fill: false
  activation:
    type: unfeaturized
    auto_fill: false
  study_restriction:
    type: unfeaturized
    auto_fill: false
  terms:
    type: categorical
    values:
      - yes
  age:
    type: unfeaturized
    auto_fill: false
  gender:
    type: unfeaturized
    auto_fill: false
  province:
    type: unfeaturized
    auto_fill: false
  location:
    type: unfeaturized
    auto_fill: false
  location_confirm:
    type: unfeaturized
    auto_fill: false
  location_coords:
    type: unfeaturized
    auto_fill: false
  city_location_coords:
    type: unfeaturized
    auto_fill: false
  symptoms_cough:
    type: unfeaturized
    auto_fill: false
  symptoms_fever:
    type: unfeaturized
    auto_fill: false
  symptoms_sweat:
    type: unfeaturized
    auto_fill: false
  symptoms_weight:
    type: unfeaturized
    auto_fill: false
  exposure:
    type: unfeaturized
    auto_fill: false
  tracing:
    type: unfeaturized
    auto_fill: false
  research_consent:
    type: unfeaturized
    auto_fill: false
  soft_commitment:
    type: unfeaturized
    auto_fill: false
  soft_commitment_plus:
    type: unfeaturized
    auto_fill: false
  group_arm:
    type: unfeaturized
  tbcheck_id:
    type: unfeaturized
  clinic_list:
    type: unfeaturized
    auto_fill: false
  clinic_visit_day:
    type: unfeaturized
    auto_fill: false
  nearest_clinic:
    type: unfeaturized
    auto_fill: false
  original_clinic_list:
    type: unfeaturized
    auto_fill: false

forms:
  - tbcheck_form
  - tbcheck_terms_form
  - tbcheck_profile_form
  - group_arm_form

responses:
  utter_ask_mobile_no:
      - text: |
          Nceda ufake inombolo yefowuni ephathwayo yomntu lowo owenzelwa le TBCheck.

  utter_invalid_mobile_no:
      - text: |
          Invalid mobile number.

  utter_welcome:
      - text: |
          *I-TB HealthCheck* sisixhobo sakho sokutshekitsha i-TB. Oku kunokukuxelela ukuba udinga uvavanyo lwe-TB.

          Uvavanyo lwe-TB luza kukuxelela ukuba une-TB okanye akunjalo. I-TB sisifo esinyangekayo. Ihlala ichaphazela imiphunga. Nceda uphendule imibuzo embalwa ukufumana ingcebiso ngento oza kuyenza ngokulandelayo.


          Enkosi ngokuthatha ulawulo ngempilo yakho.

  utter_welcome_back:
      - text: |
          Wamkelekile kwi *TB HealthCheck*, isixhobo sakho sokujonga i-TB. Enkosi ngokuthatha ulawulo ngempilo yakho.

  utter_ask_terms:
      - text: |
          Phendula ngegama elinye ELINGQINDILILI ukuqhubeka

          *YAMKELA* ✅ -_ ukwamkela imigaqo kunye nemiqathango_
          *FUNDA* 📄 - _ukufunda imigaqo kunye nemiqathango_

          (okanye Phendula IMENYU 📌 _ukubuyela kwimenyu yakuqala_)

  utter_more_terms:
      - text: |
          Le nkonzo inikezela ngolwazi kuphela kwaye ayithathi indawo yengcebiso zonyango /yokuxilonga/yonyango. Fumana iingcebiso zomboneleli wezempilo malunga nemeko yonyango / inkathalo, ngakumbi ukuba uvelisa iimpawu ezinzima.

          Uxhomekeke kolu lwazi ngokomngcipheko wakho. Uyavuma ukuba unoxanduva lonyango lwakho. Uyavuma ukuba akufuneki ukungahoyi / ulibazise ukufumana iingcebiso zonyango malunga nonyango / ukhathalelo ngenxa yale nkonzo.

  utter_ask_research_consent:
      - text: |
          Into yokugqibela...

          Sinokubuza imibuzo embalwa elula yokuphanda emva kokuba uyigqibile i-TB HealthCheck yakho. Ukuthatha uphando KUMAHALA kwaye akuyi kusebenzisa ne-airtime encinci. Siza kusebenzisa olu lwazi ukubona ukuba i-TB HealthCheck iyabanceda abantu. 
          
          Ngaba uzimisele ukuthatha inxaxheba? 
          
           1. EWE, ndifuna ukuthatha inxaxheba 
           2. HAYI, enkosi

  utter_more_terms_doc:
    - document: "https://healthcheck-rasa-images.s3.af-south-1.amazonaws.com/NDOH_WhatsApp_TB_Privacy_Policy_September2021.pdf"
      text: Imigaqo kunye Nemiqathango

  utter_ask_province:
    - text: |
        Uhlala kweliphi iphondo ngoku?

        *1.* IMPUMA KOLONI
        *2.* I-FREE STATE
        *3.* IRHAWUTI
        *4.* KWAZULU NATAL
        *5.* ILIMPOMPO
        *6.* IMPUMALANGA
        *7.* EMTLA NTSHONA
        *8.* UMNTLA KOLONI
        *9.* INTSHONA KOLONI

  utter_incorrect_selection:
    - text: |
        Le nkonzo isebenza kakuhle xa usebenzisa ukhetho olubhalwe ngo *NOBUMBA ABANQGINDILILI*.

        📌 Phendula uthi *IMENYU* ukuze ubuyele kwi menyu yakuqala

  utter_incorrect_location:
    - text: |
        Ukuba idilesi yakho uyibhudile, cela uphinde uzame ukuyibhala kakuhle. Ukuba awuzukwazi ukubhala idilesi, bhala igama lenginqi, ilokishi, idolophi okanye ilali yakho (okanye esondelene nawe)

  utter_ask_age:
    - text: |
        Unangaphi?

        *1.* Ngaphantsi kwe-18
        *2.* 18-39
        *3.* 40-65
        *4.* Ngaphezu kwa-65

  utter_ask_gender:
    - text: |
        Sesiphi isini ozichonga njengaso?

        *1.* INDODA
        *2.* UMFAZI
        *3.* ENYE
        *4.* UKHETHA UKUNGATSHO

  utter_ask_location:
    - text: |
        Enkosi. Ngoku sidinga indawo okuyo.

        Nceda UBHALE idilesi yakho yasekhaya (okanye idilesi ohlala kuyo ngoku). Nika inombolo yesitalato, igama lesitalato, ihlomela ledolophu / ilokishi / idolophu / ilali

  utter_ask_location_confirm:
    - text: |
        Sisebenzisa iinkonzo zendawo zikaGoogle ukuqinisekisa indawo okuyo. Nceda ujonge ukuba le dilesi ingezantsi ichanekile kwaye iyangqinelana nolwazi olunikezeleyo:
        {location}

        *1.* EWE
        *2.* HAYI

  utter_ask_symptoms_cough:
    - text: |
        ⬛⬜⬜⬜⬜⬜

        Masibone ukuba uziva njani namhlanje. Unokhohlokhohlo?

        *1.* EWE
        *2.* HAYI

  utter_ask_symptoms_fever:
    - text: |
        ⬛⬛⬜⬜⬜⬜

        Unobushushu unefiva? (xa uchukumisa ibunzi lakho, ngaba uziva ushushu?)

        *1.* EWE
        *2.* HAYI

  utter_ask_symptoms_sweat:
    - text: |
        ⬛⬛⬛⬜⬜⬜

        Ingaba ubila ngaphezulu kunesiqhelo ebusuku?

        *1.* EWE
        *2.* HAYI

  utter_ask_symptoms_weight:
    - text: |
        ⬛⬛⬛⬛⬜⬜

        Ingaba uye wehla emzimbeni ngaphandle kokuzama?

        *1.* EWE
        *2.* HAYI

  utter_ask_exposure:
    - text: |
        ⬛⬛⬛⬛⬛⬜

        Ingaba usemngciphekweni omkhulu we-TB?

        _Usemngciphekweni omkhulu we-TB ukuba:_
        _Uhlala nomntu one-TB kunyaka ophelileyo, OKANYE ubune-TB kule minyaka mibini idlulileyo, OKANYE uphila ne-HIV._

        *1.* Ndisemngciphekweni omkhulu we-TB
        *2.* Andikho semngciphekweni omkhulu we-TB
        *3.* Andiyazi ukuba ndisemngciphekweni omkhulu

  utter_ask_tracing:
    - text: |
        ⬛⬛⬛⬛⬛⬛

        Okokugqibela, nceda uvume ukuba ulwazi owabelane ngalo *luchanekile* ngokolwazi lwakho lonke kwaye unika iSebe lezeMpilo likaZwelonke imvume yokunxibelelana nawe xa kufuneka njalo?

        *1.* EWE
        *2.* HAYI

  utter_risk_high:
    - text: |
        *Iimpendulo zakho kule mibuzo zibonisa ukuba udinga uvavanyo lwe-TB kwiveki ezayo*

        - Yiya kwikliniki yakho yengingqi uyofumana uvavanyo lwe-TB lwasimahla
        - Nceda unxibe imaski yobuso phambi kokuba ungene eklinikhi.

  utter_risk_moderate:
    - text: |
        *Iimpendulo zakho kule mibuzo zibonisa ukuba udinga uvavanyo lwe-TB kwiveki ezayo*

        - Yiya kwikliniki yakho yengingqi uyofumana uvavanyo lwe-TB lwasimahla
        - Nceda unxibe imaski yobuso phambi kokuba ungene eklinikhi.

  utter_risk_low:
    - text: |
        *Akudingi vavanyo lwe-TB ngeli xesha.*

        - Ukuba ngaba uyakhohlela, unomkhuhlane, ukunciphisa umzimba okanye ukubila ebusuku, ndwendwela iklinikhi ekufutshane nawe.

  utter_control:
    - text: |
        *Iimpendulo zakho kwimibuzo zibonisa ukuba udinga uvavanyo lwe-TB kule veki.* 

        🩸 Ndwendwela ikliniki yengingqi yakho ukwenza uvavanyo lwe-TB lwamahala.
        😷 Nceda unxibe imaski ngaphambi kokuba ungene ekliniki.

  utter_health_consequence:
    - text: |
        *Iimpendulo zakho kwimibuzo zibonisa ukuba udinga uvavanyo lwe-TB kule veki.* 

        Ukufunywanwa ngethuba, i-TB inokunyangeka. Ungalibazisi, vavanya namhlanje!
        
        🩸 Ndwendwela ikliniki yengingqi yakho ukwenza uvavanyo lwe-TB lwamahala.
        😷 Nceda unxibe imaski ngaphambi kokuba ungene ekliniki. 

  utter_planning_prompt:
    - text: |
        *Iimpendulo zakho kwimibuzo zibonisa ukuba udinga uvavanyo lwe-TB kule veki.*

        Nazi ezinye zeengcebiso zokukunceda ucwangcise:
        
        🟢 Yenza ixesha. Impilo yakho ibalulekile!
        🟢 Khetha eyona klinikhi elula kakhulu kuwe ukwenza uvavanyo lwakho. Ngezantsi ziikliniki ezi-5 ezikufutshane kuwe.
        🟢 Nceda unxibe imaski ngaphambi kokuba ungene ekliniki.
        🟢 Fika kwangexesha! iiKlinikhi zivulwa ukuba ufumane uvavanyo lweTB ngoMvulo ukuya ngoLwesihlanu kusasa.

  utter_ask_clinic_list:
    - text: |
        *Uza kuvavanywa phi?* 
        
        Phendula ngekliniki:
        {nearest_clinic}

  utter_ask_clinic_visit_day:
    - text: |
        *Uza kuvavanywa nini?*
        
        *1.* MVULO
        *2.* LWESIBINI
        *3.* LWESITHATHU
        *4.* LWESINE
        *5.* LWESIHLANU

  utter_ask_soft_commitment:
    - text: |
        ⚠️ *Iimpendulo zakho kwimibuzo zibonisa ukuba udinga uvavanyo lwe-TB kule veki.*

        🩸 Yiya kwiklinikhi yengingqi yakho ukufumana uvavanyo lwamahala lwe-TB.
        😷 Nceda unxibe imaski ngaphambi kokuba ungene ekliniki.
        
        Ingaba uyazibophelela ukuba uzakuvavanya?
        
        *1. EWE* 
        *2. HAYI*

  utter_commitment_yes:
    - text: |
        Wenze kakuhle ngokuzibophelela ekunakekeleni impilo yakho! 👏
      claim: release

  utter_soft_commitment_no:
    - text: |
        ⚠️ *Khumbula: kubalulekile ukuba uvavanyelwe i-TB*
        Fumana uvavanyo lwakho kungekudala ukuba awukalenzi!
      claim: release

  utter_ask_soft_commitment_plus:
    - text: |
        ⚠️ *⚠️ Iimpendulo zakho kwimibuzo zibonisa ukuba udinga uvavanyo lwe-TB kule veki.*

        🩸 Yiya kwiklinikhi yengingqi yakho ukufumana uvavanyo lwamahala lwe-TB.
        😷 Nceda unxibe imaski ngaphambi kokuba ungene ekliniki.
        📲 Uya kufumana i-airtime ye-R10 ukuba uyazibophelela ukuba uvavanywe. I-Airtime iya kuthunyelwa kuwe phambi kokudlula kweyure enye.
        
        Ingaba uyazibophelela ukuba uzakuvavanya?

        *1. EWE* 
        *2. HAYI*

  utter_soft_commitment_plus_no:
    - text: |
        ⚠️ Nokuba awukwazi ukuzibophelela ngoku, kusabalulekile ukuba uvavanye.
      claim: release

  utter_risk_low_unknown_exposure:
    - text: |
        Jonga abo uhlala nabo bakunyango lwe TB na.

        Ukuba awusazi isimo sakho se HIV yiya eklinikhi uhlolwe mahala.

        Buya wenze uhlolo lwe TB kwakhona xa unolulwazi.

  utter_follow_up_request:
    - text: |
        📲 Ukufumana imiyalezo yokulandelelisa, phendula *PHAKATHI*
      claim: release

  utter_keywords:
    - text: |
        💊 *UNYANGO* ngolwazi malunga nonyango
        📗 *IZIXHOBO* ngolwazi malunga neempawu kunye nokuvavanywa lwe-TB
        📌 *uthi *IMENYU* ukuze ubuyele kwi menyu yakuqala
      claim: release

  utter_opt_in_yes:
    - text: |
        Enkosi ngokukhetha ukufumana imiyalezo yethu yokulandelisa.

        📌 Phendula uthi *IMENYU* ukuze ubuyele kwi menyu yakuqala
      claim: release

  utter_do_tb_screening:
    - text: |
        Phendula ubhale TB ukuze uzoqala ukuhlolelwa i-TB
      claim: release

  utter_study_completed:
    - text: |
        ⚠️Unfortunately, you cannot participate in the study more than once.
        You can still continue with a TB Check but you will not be included
        in the study.
      claim: release

  utter_study_minor_error:
    - text: |
        ⚠️  Unfortunately you cant participate in the study if you are younger
        than 18. You can still continue with a TB Check but you will not be 
        included in the study.
      claim: release

  utter_research_consent_no:
    - text: |
        Okay, no problem. You will not be included in the research, but you can still 
        continue to check if you need to take a TB test.

  utter_research_consent_more_p1:
    - text: |
        *Can you tell me more about the research?*
        
        We are conducting a study about the TB HealthCheck tool.
        We will ask you about your choices in relation to the tool.
        
        *What information will you ask me for?*

        We'll never ask your name, but may ask your ID number so that we can help 
        to link you to a facility to get tested. Providing your ID is completely up to you.
        We would only use it for your benefit.
        
        *Why did I get this SMS?*

        We have chosen you at random from a database hosted by the Western Cape Department of Health.

  utter_research_consent_more_p2:
    - text: |
        *What will I need to do?*

        We will ask you a few questions and it will take about 6 minutes of your time.

        *What will happen to the information?*

        We will store it safely as required by law and it will only be used by the Stellenbosch University
        and Erasmus University researchers.
        
        The information is stored without your name and ID. We will share what we find other researchers 
        and journals what we find, but what we share will be based on averages and totals from the full 
        group of survey participants.

  utter_research_consent_more_p3:
    - text: |
        *What if I want to stop halfway through the survey?*

        That's OK. You can stop at any point.
        
        *Are there any costs or risks to me?*

        There are no costs and no risks. Your information will be kept private and safe. 
        The researchers will receive the answers without names or ID numbers.
        
        *What can I do if I am unhappy?*

        If you have questions or doubts about this invitation, please contact Ronelle Burger on 
        0838863016 or at rburger@sun.ac.za.
        
        TB HealthCheck has been approved by the Health Research Ethics Committee. 
        You can contact them by calling 021 938 9677 or 021 938 9819.

# claim: revert will ignore the message text, and reevaluate this message using
# turn automation
  utter_exit:
    - text: "Ukuhlolelwa I-TB ungakwenza noba kunini ngokubhala igama *TB*"
      claim: revert

session_config:
  session_expiration_time: 5
  carry_over_slots_to_new_session: true
